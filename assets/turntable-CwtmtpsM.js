import{G as p}from"./index-BQGGCsVa.js";const c=e=>document.getElementById(e),w=`A clean product turntable video.
The camera stays fixed and centered.
The product rotates smoothly 360 degrees clockwise on a studio turntable.
Keep the product’s exact shape, logo, stitching, and textures consistent with the reference images.
Neutral background, soft studio lighting. No warping, no morphing, no extra objects, no text.`;async function f(e){const o=e.type||"image/png";return{base64:await new Promise((n,d)=>{const r=new FileReader;r.onload=()=>{const s=String(r.result),a=s.indexOf(",");n(a>=0?s.slice(a+1):s)},r.onerror=d,r.readAsDataURL(e)}),mimeType:o}}async function h(e,o){const t=await fetch(e,{headers:{"x-goog-api-key":o}});if(!t.ok){const n=await t.text().catch(()=>"");throw new Error(`video download failed: ${t.status} ${t.statusText}
${n}`)}return await t.blob()}function b(e,o){const t=URL.createObjectURL(o);return e.src=t,t}function y(e,o="turntable.mp4"){const t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=o,document.body.appendChild(n),n.click(),n.remove(),setTimeout(()=>URL.revokeObjectURL(t),3e4)}function v(e){const o=e.length;if(o<3)throw new Error("이미지는 최소 3장(앞/옆/뒤)이 필요합니다.");if(o===3)return[e[0],e[1],e[2]];const t=Math.floor(o/2);return[e[0],e[t],e[o-1]]}async function x({apiKey:e,prompt:o,refImages:t}){const n=new p({apiKey:e}),d=t.map(i=>({image:{imageBytes:i.imageBytes,mimeType:i.mimeType},referenceType:"asset"}));let r=await n.models.generateVideos({model:"veo-3.1-generate-preview",prompt:o,config:{aspectRatio:"16:9",durationSeconds:8,resolution:"720p",negativePrompt:"text, watermark, extra objects, extra parts, warped, melted, morphing, changing logo, changing pattern, jitter, blur",referenceImages:d,numberOfVideos:1}});for(;!r.done;)await new Promise(i=>setTimeout(i,2e3)),r=await n.operations.getVideosOperation({operation:r});const s=r.response?.generatedVideos;if(!s?.length){console.log("Veo operation (no videos):",r);const i=r.error?.message||r.response?.error?.message;throw new Error(i||"Video generation completed but generatedVideos is empty.")}const a=s[0]?.video?.uri;if(!a)throw console.log("Veo operation (no uri):",r),new Error("generatedVideos exists but video.uri is missing.");return{videoUri:a}}const k=document.querySelector("#apiKey"),L=document.querySelector("#files"),l=document.querySelector("#gen"),T=document.querySelector("#video"),u=document.querySelector("#dl");let m=null;l.addEventListener("click",async()=>{try{const e=k.value.trim();if(!e)throw new Error("API Key 넣어주세요.");const o=Array.from(L.files||[]),t=v(o);l.disabled=!0,u.disabled=!0,c("result").hidden=!1,c("result").classList.add("__processing"),console.log("uploading & generating...");const d=(await Promise.all(t.map(f))).map(({base64:i,mimeType:g})=>({imageBytes:i,mimeType:g})),r=w,{videoUri:s}=await x({apiKey:e,prompt:r,refImages:d}),a=await h(s,e);m=a,b(T,a),u.disabled=!1}catch(e){console.error(e),alert(String(e?.message||e))}finally{l.disabled=!1,c("result").classList.add("__success")}});u.addEventListener("click",()=>{m&&y(m,"turntable.mp4")});c("resultClose").onclick=()=>{c("result").hidden=!0,c("result").classList.remove("__success")};
