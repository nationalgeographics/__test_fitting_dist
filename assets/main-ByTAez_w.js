import{G as h}from"./index-BpBbR1cK.js";const e=t=>document.getElementById(t),w=`너는 가상 피팅(try-on) 편집을 수행한다.

- 첫 번째 이미지는 '사람 사진'이다.
- 두 번째 이미지는 '상품(의류) 사진'이다.

요구사항:
1) 사람의 얼굴/헤어/체형/포즈/배경/조명은 최대한 유지한다.
2) 상품 의류를 사람이 실제로 입은 것처럼 자연스럽게 합성한다.
3) 옷의 로고/패턴/프린트/봉제선이 있다면 가능한 유지한다.
4) 어색한 겹침(팔/머리/의류 겹침)과 비현실적인 주름을 줄인다.
5) 결과는 '실사 사진' 톤으로 만든다.`;function _(t){return new Promise((a,n)=>{const o=new FileReader;o.onload=()=>{const r=o.result,s=String(r).split(",")[1];a(s)},o.onerror=n,o.readAsDataURL(t)})}async function v(t){const n=await(await fetch(t)).blob();return await _(n)}function u(){const t=e("productCode").value;if(!t)return alert("상품 코드를 넣어주세요");e("productImage").src=`https://img.nstationmall.com/mall/goods/000/000/${t.toString().padStart(6,"0").match(/.{1,3}/g).join("/")}/view_1.jpg`}u();e("saveProduct").addEventListener("click",()=>{u()});function g(){const t=localStorage.getItem("tryon_my_photo_dataurl");e("myPhotoPreview").src=t||""}g();e("saveMyPhoto").addEventListener("click",async()=>{const t=e("myPhoto").files?.[0];if(!t)return alert("내 사진을 등록해주세요");const a=new FileReader;a.onload=()=>{localStorage.setItem("tryon_my_photo_dataurl",a.result),g(),alert("저장 완료!")},a.readAsDataURL(t)});e("runTryOn").addEventListener("click",async()=>{const t=e("apiKey").value.trim();if(!t)return alert("API Key를 넣어주세요");const a=localStorage.getItem("tryon_my_photo_dataurl");if(!a)return alert("내 사진을 먼저 저장해주세요");const n=e("productImage").src;if(!n)return alert("상품 코드를 적용해주세요");e("runTryOn").disabled=!0,e("result").hidden=!1,e("result").classList.add("__processing"),console.log("uploading & generating...");try{const o=new h({apiKey:t}),r=a.split(",")[1],s=a.substring(a.indexOf(":")+1,a.indexOf(";")),p=await v(n),c=(await o.models.generateContent({model:"gemini-3-pro-image-preview",contents:[{text:w},{inlineData:{mimeType:s,data:r}},{inlineData:{mimeType:"image/jpeg",data:p}}],config:{responseModalities:["TEXT","IMAGE"],imageConfig:{aspectRatio:"3:4",imageSize:"2k"}}}))?.candidates?.[0]?.content?.parts||[],i=c.find(l=>l.inlineData?.data),d=c.find(l=>l.text);if(d?.text?console.log(d.text):console.log("generated. (no text part)"),!i?.inlineData?.data)throw new Error("오류 - 프롬프트 또는 모델/비율 확인 필요");const y=i.inlineData.mimeType||"image/png",f=i.inlineData.data,m=`data:${y};base64,${f}`;e("result").classList.add("__success"),e("resultImg").src=m,e("downloadLink").href=m,e("downloadLink").style.display="inline-block"}catch(o){e("result").hidden=!0,console.error(o),console.log(String(o?.message||o)),alert("에러! 로그를 확인해주세요.")}finally{e("runTryOn").disabled=!1,e("result").classList.remove("__processing")}});e("resultClose").onclick=()=>{e("result").hidden=!0,e("result").classList.remove("__success"),e("resultImg").src="",e("downloadLink").href="#",e("downloadLink").style.display="none"};
